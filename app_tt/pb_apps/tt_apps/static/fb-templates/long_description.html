<div id="mb" style="display: none"></div>
<div id="books" style="display: none"></div>

<script>
	var bookId;
	
	$('#mb').load("https://" + server_name + "/mb", function() {
		$('#footer_links').hide();
		$('#mb').show();
		$('#mb .btn .btn-success').click(handleStartContributingClickEvent);
		$(".container-wrapper a").click(handleStartContributingClickEvent);
	});
	
	function handleStartContributingClickEvent(e) {
		e.preventDefault();
		initFacebookSDK();
		loadBooksPage("/mb/collaborate");
	}
	
	function loadBooksPage(url) {
		$('#mb').hide();
		$('#books').hide();
		
		$('#books').load("https://" + server_name + url, function() {
			$('#books #footer_links').hide();
			$('#books').show();
			
			$(".container-wrapper a").click(function (e) {
				e.preventDefault();
				
		        var addressValue = $(this).attr("href");
		        
		        if (addressValue == "#") return;
		        
		        if (addressValue.indexOf("collaborate") != -1) {
		        	loadBooksPage(addressValue);
		        	return;
		        }
		        
		        var POSITION_BOOK_ID = 5;
		        var tmp = addressValue.split("/")[POSITION_BOOK_ID];
		        bookId = tmp.substring(0, tmp.indexOf("_"));
		        
		        $("#task-template").load("template.html", function() {
		        	showTaskTemplate();
		        });
		    });
		});
	}
</script>